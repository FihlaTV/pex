<!DOCTYPE html>

<html>
<head>
  <title>Utils.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Utils.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> Context = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Context'</span>);

<span class="hljs-built_in">module</span>.exports.getCurrentContext = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">return</span> Context.currentContext;
}

<span class="hljs-built_in">module</span>.exports.clearColor = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(color)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  <span class="hljs-keyword">if</span> (color)
    gl.clearColor(color.r, color.g, color.b, color.a);
  gl.clear(gl.COLOR_BUFFER_BIT);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.clearDepth = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  gl.clear(gl.DEPTH_BUFFER_BIT);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.clearColorAndDepth = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(color)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  color = color || { r: <span class="hljs-number">0</span>, g:<span class="hljs-number">0</span>, b:<span class="hljs-number">0</span>, a: <span class="hljs-number">1</span>};
  gl.clearColor(color.r, color.g, color.b, color.a);
  gl.depthMask(<span class="hljs-number">1</span>);
  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.enableDepthReadAndWrite = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(depthRead, depthWrite)</span> </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>do nothing, just use the values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>use the same value for both read and write</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    depthWrite = depthRead;
  }
  <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>defaults</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    depthRead = <span class="hljs-literal">true</span>;
    depthWrite = <span class="hljs-literal">true</span>;
  }

  <span class="hljs-keyword">var</span> gl = Context.currentContext;

  <span class="hljs-keyword">if</span> (depthWrite) gl.depthMask(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">else</span> gl.depthMask(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">if</span> (depthRead) gl.enable(gl.DEPTH_TEST);
  <span class="hljs-keyword">else</span> gl.disable(gl.DEPTH_TEST);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.enableAdditiveBlending = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.enableBlending(<span class="hljs-string">"ONE"</span>, <span class="hljs-string">"ONE"</span>);
};

<span class="hljs-built_in">module</span>.exports.enableAlphaBlending = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(src, dst)</span> </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.enableBlending(<span class="hljs-string">"SRC_ALPHA"</span>, <span class="hljs-string">"ONE_MINUS_SRC_ALPHA"</span>);
};

<span class="hljs-built_in">module</span>.exports.enableBlending = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(src, dst)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  <span class="hljs-keyword">if</span> (src === <span class="hljs-literal">false</span>) {
    gl.disable(gl.BLEND);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }
  gl.enable(gl.BLEND);
  gl.blendFunc(gl[src], gl[dst]);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>OpenGL viewport 0,0 is in bottom left corner</p>
<p> 0,h——-w,h
  |       |
  |       |
 0,0——-w,0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">module</span>.exports.viewport = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x, y, w, h)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  gl.viewport(x, y, w, h);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.scissor = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x, y, w, h)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  <span class="hljs-keyword">if</span> (x === <span class="hljs-literal">false</span>) {
    gl.disable(gl.SCISSOR_TEST);
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x.width != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">var</span> rect = x;
    gl.enable(gl.SCISSOR_TEST);
    gl.scissor(rect.x, rect.y, rect.width, rect.height);
  }
  <span class="hljs-keyword">else</span> {
    gl.enable(gl.SCISSOR_TEST);
    gl.scissor(x, y, w, h);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.cullFace = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(enabled)</span> </span>{
  enabled = (enabled !== <span class="hljs-literal">undefined</span>) ? enabled : <span class="hljs-literal">true</span>
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  <span class="hljs-keyword">if</span> (enabled)
    gl.enable(gl.CULL_FACE);
  <span class="hljs-keyword">else</span>
    gl.disable(gl.CULL_FACE);
  gl.cullFace(gl.BACK);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

<span class="hljs-built_in">module</span>.exports.lineWidth = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(width)</span> </span>{
  <span class="hljs-keyword">var</span> gl = Context.currentContext;
  gl.lineWidth(width);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
